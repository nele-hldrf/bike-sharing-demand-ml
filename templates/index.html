<!doctype html>
<html lang="de">
    <head>
      <meta charset="utf-8">
      <title>ML Demo – Seoul Bike Sharing Prediction</title>
      <style>
        body { font-family: sans-serif; max-width: 600px; margin: 40px auto; }
        label { display: block; margin-top: 10px; }
        input { width: 100%; padding: 6px; }
        button { margin-top: 15px; padding: 8px 12px; }
        #result { margin-top: 20px; font-weight: bold; white-space: pre-line; }
      </style>
    </head>
    <body>
        <h1>ML Demo – Seoul Bike Sharing Prediction</h1>
        <p>Fill in the information for your preferred date.</p>

        <label>Hour:
            <input id="hour" type="number" min="0" max="23" value="12">
        </label>

        <label>Temperature (°C):
            <input id="temp" type="number" step="0.1" value="10">
        </label>

        <label>Humidity (%):
            <input id="hum" type="number" min="0" max="100" value="50">
        </label>

        <label>Wind Speed (m/s):
            <input id="wind" type="number" step="0.1" value="2.0">
        </label>

        <label>Visibility (m):
            <input id="vis" type="number" value="1800">
        </label>

        <label>Dew Point Temperature (°C):
            <input id="dew" type="number" step="0.1" value="5">
        </label>

        <label>Solar Radiation (MJ/m²):
            <input id="solar" type="number" step="0.01" value="0.00">
        </label>

        <label>Rainfall (mm):
            <input id="rain" type="number" step="0.1" value="0.0">
        </label>

        <label>Snowfall (cm):
            <input id="snow" type="number" step="0.1" value="0.0">
        </label>

        <label>Seasons:
            <select id="season">
                <option value="Spring">Spring</option>
                <option value="Summer">Summer</option>
                <option value="Winter">Winter</option>
                <option value="Autumn">Autumn</option>
            </select>
        </label>

        <label>Holiday:
            <select id="holiday">
                <option value="0">No Holiday</option>
                <option value="1">Holiday</option>
            </select>
        </label>

        <button onclick="sendPredict()">Predict</button>

        <div id="result"></div>

        <script>
        // Diese Funktion wird beim Klick auf den Button aufgerufen.
        async function sendPredict() {
            const payload = {
                features: {
                    Hour: parseInt(document.getElementById('hour').value),
                    Temperature: parseFloat(document.getElementById('temp').value),
                    Humidity: parseFloat(document.getElementById('hum').value),
                    Wind_speed: parseFloat(document.getElementById('wind').value),
                    Visibility: parseInt(document.getElementById('vis').value),
                    Dew_point_temperature: parseFloat(document.getElementById('dew').value),
                    Solar_Radiation: parseFloat(document.getElementById('solar').value),
                    Rainfall: parseFloat(document.getElementById('rain').value),
                    Snowfall: parseFloat(document.getElementById('snow').value),
                    Holiday_No_Holiday: parseInt(document.getElementById('holiday').value),
                
                    // Season wird erst im Backend in One-Hot encodiert
                    Season: document.getElementById('season').value
                }
            };

            const resDiv = document.getElementById('result');
            resDiv.textContent = "Bitte warten...";

            try {
                const response = await fetch('/predict', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errText = await response.text();
                    resDiv.textContent = "Fehler: " + errText;
                    return;
                }

                const data = await response.json();
                resDiv.textContent = "Predicted bike rentals: " + Math.round(data.prediction);

          } catch (err) {
            resDiv.textContent = "Fehler beim Request: " + err;
          }
        }
      </script>
    </body>
</html>